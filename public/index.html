<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Игра - GARAGE</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- ВАЖНО: Добавьте Socket.io перед вашим script.js -->
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
</head>
<body>
    <div class="game-container">
        <!-- ВИДЕО КОНТЕЙНЕР В ВЕРХУ -->
        <div class="video-container">
            <div class="video-box">
                <div class="video-placeholder" id="video-master">
                    <i class="fas fa-user-tie"></i>
                    <p>Ведущий</p>
                </div>
            </div>
            <div class="video-box">
                <div class="video-placeholder" id="video-team1">
                    <i class="fas fa-user"></i>
                    <p>Команда 1</p>
                    <div class="current-turn-indicator" id="turn-indicator-1">ХОД</div>
                </div>
            </div>
            <div class="video-box">
                <div class="video-placeholder" id="video-team2">
                    <i class="fas fa-user"></i>
                    <p>Команда 2</p>
                    <div class="current-turn-indicator" id="turn-indicator-2">ХОД</div>
                </div>
            </div>
        </div>

        <!-- Верхняя панель с информацией -->
        <div class="top-panel">
            <div class="score-board">
                <div class="team-score" id="team1-score">
                    <h3>Команда 1</h3>
                    <div class="score">0</div>
                </div>
                <div class="dice-container">
                    <div class="dice" id="dice">?</div>
                    <button id="roll-dice" class="btn">Бросить кубик</button>
                    <div id="task-type"></div>
                </div>
                <div class="team-score" id="team2-score">
                    <h3>Команда 2</h3>
                    <div class="score">0</div>
                </div>
            </div>
            
            <div class="timer-container">
                <div id="timer">60</div>
                <div class="timer-label">секунд</div>
            </div>
        </div>

        <!-- Основное игровое поле -->
        <div class="main-game-area">
            <!-- Колоды карт слева -->
            <div class="decks-left">
                <div class="deck" id="kitchen-deck" data-type="1">
                    <div class="deck-label">Кухня</div>
                </div>
                <div class="deck" id="bar-deck" data-type="2">
                    <div class="deck-label">Бар</div>
                </div>
                <div class="deck" id="knowledge-deck" data-type="3">
                    <div class="deck-label">Знания</div>
                </div>
            </div>

            <!-- Игровое поле -->
            <div class="game-board">
                <canvas id="board-canvas"></canvas>
                <div class="pieces">
                    <div class="piece" id="piece1" data-team="1"></div>
                    <div class="piece" id="piece2" data-team="2"></div>
                </div>
                <div id="cells-container">
                    <!-- Клетки будут сгенерированы через JS -->
                </div>
            </div>

            <!-- Колоды карт справа -->
            <div class="decks-right">
                <div class="deck" id="situation-deck" data-type="4">
                    <div class="deck-label">Ситуация</div>
                </div>
                <div class="deck" id="service-deck" data-type="5">
                    <div class="deck-label">Сервис</div>
                </div>
                <div class="deck" id="sales-deck" data-type="6">
                    <div class="deck-label">Продажи</div>
                </div>
            </div>
        </div>

        <!-- Центральная карточка с вопросом -->
        <div class="card-modal" id="card-modal">
            <div class="card-content">
                <div class="card-front">
                    <div class="dice-icon" id="card-dice"></div>
                </div>
                <div class="card-back">
                    <h3 id="card-category"></h3>
                    <p id="card-question"></p>
                    <div class="card-instruction" id="card-instruction"></div>
                    <button id="answer-received" class="btn answer-btn">Завершить ответ</button>
                </div>
            </div>
        </div>

        <!-- Панель ведущего -->
        <div class="master-panel" id="master-panel">
            <h3>Панель ведущего</h3>
            <div class="points-control">
                <div class="team-control">
                    <h4>Команда 1</h4>
                    <div class="points-section">
                        <div class="plus-points">
                            <h5>Добавить очки:</h5>
                            <!-- В секции командных очков добавьте: -->
<div class="zero-points" style="margin: 10px 0;">
    <h5 style="color: #FFC107;">Без очков:</h5>
    <button class="point-btn zero-btn" data-points="0" data-team="1" 
            style="background: #FFC107; color: black;">0</button>
</div>
                            <div class="points-buttons">
                                <button class="point-btn plus-btn" data-points="1" data-team="1">+1</button>
                                <button class="point-btn plus-btn" data-points="2" data-team="1">+2</button>
                                <button class="point-btn plus-btn" data-points="3" data-team="1">+3</button>
                            </div>
                        </div>
                        <div class="minus-points">
                            <h5>Вычесть очки:</h5>
                            <div class="points-buttons">
                                <button class="point-btn minus-btn" data-points="-1" data-team="1">-1</button>
                                <button class="point-btn minus-btn" data-points="-2" data-team="1">-2</button>
                                <button class="point-btn minus-btn" data-points="-3" data-team="1">-3</button>
                            </div>
                        </div>
                    </div>
                    <div class="current-selection" id="team1-selection">
                        Выбрано: <span>0 очков</span>
                    </div>
                </div>
                <div class="team-control">
                    <h4>Команда 2</h4>
                    <div class="points-section">
                        <div class="plus-points">
                            <h5>Добавить очки:</h5>
                            <!-- В секции командных очков добавьте: -->
<div class="zero-points" style="margin: 10px 0;">
    <h5 style="color: #FFC107;">Без очков:</h5>
    <button class="point-btn zero-btn" data-points="0" data-team="1" 
            style="background: #FFC107; color: black;">0</button>
</div>
                            <div class="points-buttons">
                                <button class="point-btn plus-btn" data-points="1" data-team="2">+1</button>
                                <button class="point-btn plus-btn" data-points="2" data-team="2">+2</button>
                                <button class="point-btn plus-btn" data-points="3" data-team="2">+3</button>
                            </div>
                        </div>
                        <div class="minus-points">
                            <h5>Вычесть очки:</h5>
                            <div class="points-buttons">
                                <button class="point-btn minus-btn" data-points="-1" data-team="2">-1</button>
                                <button class="point-btn minus-btn" data-points="-2" data-team="2">-2</button>
                                <button class="point-btn minus-btn" data-points="-3" data-team="2">-3</button>
                            </div>
                        </div>
                    </div>
                    <div class="current-selection" id="team2-selection">
                        Выбрано: <span>0 очков</span>
                    </div>
                </div>
            </div>
            <div class="master-actions">
                <button id="apply-points" class="btn apply-btn">Применить очки</button>
                <button id="next-turn" class="btn">Следующий ход</button>
            </div>
        </div>

        <!-- Салюты при победе -->
        <div id="fireworks"></div>
    </div>

    <script src="script.js"></script>
<!-- Кнопка для администратора (только для локального использования) -->
<div id="admin-panel" style="position: fixed; bottom: 10px; left: 10px; z-index: 1000; display: none;">
    <button id="edit-questions" class="btn" style="background: #9C27B0;">
        <i class="fas fa-edit"></i> Редактировать вопросы
    </button>
</div>

<!-- Модальное окно редактирования вопросов -->
<div id="edit-questions-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <h3><i class="fas fa-edit"></i> Редактирование вопросов</h3>
        <div id="questions-editor"></div>
        <div style="margin-top: 20px;">
            <button id="save-questions" class="btn" style="background: #4CAF50;">Сохранить</button>
            <button id="cancel-edit" class="btn" style="background: #666;">Отмена</button>
        </div>
    </div>
</div>

<script>
// Код для редактирования вопросов
document.addEventListener('DOMContentLoaded', function() {
    const editBtn = document.getElementById('edit-questions');
    const modal = document.getElementById('edit-questions-modal');
    
    if (editBtn && modal) {
        editBtn.addEventListener('click', function() {
            modal.style.display = 'block';
            loadQuestionsForEditing();
        });
        
        document.getElementById('cancel-edit')?.addEventListener('click', function() {
            modal.style.display = 'none';
        });
    }
    
    function loadQuestionsForEditing() {
        // Загрузка и отображение вопросов для редактирования
        fetch('cards.json')
            .then(response => response.json())
            .then(data => {
                const editor = document.getElementById('questions-editor');
                let html = '<div class="categories-editor">';
                
                for (let category = 1; category <= 6; category++) {
                    const questions = data.categories[category] || [];
                    html += `
                        <div class="category-editor">
                            <h4>Категория ${category}: ${getCategoryName(category)}</h4>
                            <div class="questions-list" id="questions-${category}">
                    `;
                    
                    questions.forEach((q, index) => {
                        html += `
                            <div class="question-item">
                                <input type="text" class="question-input" 
                                       value="${q.question}" 
                                       data-cat="${category}" data-index="${index}"
                                       placeholder="Вопрос">
                                <input type="text" class="instruction-input"
                                       value="${q.instruction || ''}"
                                       data-cat="${category}" data-index="${index}"
                                       placeholder="Инструкция">
                                <button class="btn delete-question" style="background: #f44336;">Удалить</button>
                            </div>
                        `;
                    });
                    
                    html += `
                            </div>
                            <button class="btn add-question" data-category="${category}" 
                                    style="background: #2196F3; margin-top: 10px;">
                                <i class="fas fa-plus"></i> Добавить вопрос
                            </button>
                        </div>
                    `;
                }
                
                html += '</div>';
                editor.innerHTML = html;
                
                // Обработчики для кнопок
                document.querySelectorAll('.add-question').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const category = this.dataset.category;
                        addNewQuestion(category);
                    });
                });
                
                document.querySelectorAll('.delete-question').forEach(btn => {
                    btn.addEventListener('click', function() {
                        this.closest('.question-item').remove();
                    });
                });
            });
    }
    
    function addNewQuestion(category) {
        const questionsList = document.getElementById(`questions-${category}`);
        const newIndex = questionsList.children.length;
        
        const questionDiv = document.createElement('div');
        questionDiv.className = 'question-item';
        questionDiv.innerHTML = `
            <input type="text" class="question-input" 
                   data-cat="${category}" data-index="${newIndex}"
                   placeholder="Новый вопрос">
            <input type="text" class="instruction-input"
                   data-cat="${category}" data-index="${newIndex}"
                   placeholder="Инструкция для ответа">
            <button class="btn delete-question" style="background: #f44336;">Удалить</button>
        `;
        
        questionsList.appendChild(questionDiv);
        
        questionDiv.querySelector('.delete-question').addEventListener('click', function() {
            questionDiv.remove();
        });
    }
    
    function getCategoryName(num) {
        const names = {
            1: 'Кухня', 2: 'Бар', 3: 'Знания',
            4: 'Ситуация', 5: 'Сервис', 6: 'Продажи'
        };
        return names[num] || 'Неизвестная';
    }
});
</script>

<style>
.modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.8);
    z-index: 10000;
    display: flex;
    justify-content: center;
    align-items: center;
}

.modal-content {
    background: white;
    padding: 30px;
    border-radius: 15px;
    max-width: 800px;
    max-height: 80vh;
    overflow-y: auto;
    color: #333;
}

.categories-editor {
    display: grid;
    gap: 20px;
}

.category-editor {
    background: #f5f5f5;
    padding: 15px;
    border-radius: 10px;
}

.question-item {
    display: grid;
    grid-template-columns: 1fr 1fr auto;
    gap: 10px;
    margin-bottom: 10px;
    align-items: center;
}

.question-input, .instruction-input {
    padding: 8px;
    border: 1px solid #ddd;
    border-radius: 5px;
}
</style>
</body>
</html>
